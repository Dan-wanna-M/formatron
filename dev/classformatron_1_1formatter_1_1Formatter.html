<!-- HTML header for doxygen 1.11.0-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.11.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Formatron: formatron.formatter.Formatter Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Formatron<span id="projectnumber">&#160;dev</span>
     <!-- Version Selector -->
     <select id="versionSelector" onchange="location = this.value;">
       <option value="../v0.4.9/index.html" >v0.4.9</option>
<option value="../v0.4.8/index.html" >v0.4.8</option>
<option value="../v0.4.7/index.html" >v0.4.7</option>
<option value="../v0.4.6/index.html" >v0.4.6</option>
<option value="../v0.4.5/index.html" >v0.4.5</option>
<option value="../v0.4.4/index.html" >v0.4.4</option>
<option value="../v0.4.3/index.html" >v0.4.3</option>
<option value="../v0.4.2/index.html" >v0.4.2</option>
<option value="../v0.4.1/index.html" >v0.4.1</option>
<option value="../v0.4.0/index.html" >v0.4.0</option>
<option value="../v0.3.4/index.html" >v0.3.4</option>
<option value="../v0.3.3/index.html" >v0.3.3</option>
<option value="../v0.3.2/index.html" >v0.3.2</option>
<option value="../v0.3.1/index.html" >v0.3.1</option>
<option value="../v0.3.0/index.html" >v0.3.0</option>
<option value="../v0.2.0/index.html" >v0.2.0</option>
<option value="../v0.1.3/index.html" >v0.1.3</option>
<option value="../v0.1.2/index.html" >v0.1.2</option>
<option value="../v0.1.1/index.html" >v0.1.1</option>
<option value="../dev/index.html" selected>dev</option>
     </select>
   </div>
   <div id="projectbrief">Formatron empowers everyone to control the output format of language models with minimal overhead.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.11.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('classformatron_1_1formatter_1_1Formatter.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="classformatron_1_1formatter_1_1Formatter-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">formatron.formatter.Formatter Class Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="dynheader">
Inheritance diagram for formatron.formatter.Formatter:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classformatron_1_1formatter_1_1Formatter.png" usemap="#formatron.formatter.Formatter_map" alt=""/>
  <map id="formatron.formatter.Formatter_map" name="formatron.formatter.Formatter_map">
<area href="classformatron_1_1formatter_1_1FormatterBase.html" title="An abstract Formatter that enforces a format on the string generated by a language model." alt="formatron.formatter.FormatterBase" shape="rect" coords="0,56,206,80"/>
  </map>
</div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a369269f53f32be2f1d92663670354515" id="r_a369269f53f32be2f1d92663670354515"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a369269f53f32be2f1d92663670354515">__init__</a> (self, list[<a class="el" href="classformatron_1_1extractor_1_1Extractor.html">Extractor</a>] extractors, kbnf.Engine engine, typing.Callable[[list[int]], str] decode_callback, str <a class="el" href="#a2519969e1338beb864169289a6f36bb9">grammar_str</a>)</td></tr>
<tr class="memdesc:a369269f53f32be2f1d92663670354515"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize the formatter.  <br /></td></tr>
<tr class="separator:a369269f53f32be2f1d92663670354515"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a839eb7550ee4afbd305b25ddcca5c4dc" id="r_a839eb7550ee4afbd305b25ddcca5c4dc"><td class="memItemLeft" align="right" valign="top">kbnf.AcceptTokenResult&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a839eb7550ee4afbd305b25ddcca5c4dc">accept_token</a> (self, int token_id)</td></tr>
<tr class="memdesc:a839eb7550ee4afbd305b25ddcca5c4dc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Accept a token from the language model.  <br /></td></tr>
<tr class="separator:a839eb7550ee4afbd305b25ddcca5c4dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a178a37715ce463e6e57c530166c7ec6d" id="r_a178a37715ce463e6e57c530166c7ec6d"><td class="memItemLeft" align="right" valign="top">kbnf.AcceptTokenResult&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a178a37715ce463e6e57c530166c7ec6d">accept_bytes</a> (self, bytes _bytes)</td></tr>
<tr class="memdesc:a178a37715ce463e6e57c530166c7ec6d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Accept a bytes object from the language model.  <br /></td></tr>
<tr class="separator:a178a37715ce463e6e57c530166c7ec6d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a538f36e08b749716e6dd4c50679e2ee1" id="r_a538f36e08b749716e6dd4c50679e2ee1"><td class="memItemLeft" align="right" valign="top">None&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a538f36e08b749716e6dd4c50679e2ee1">compute_allowed_tokens</a> (self)</td></tr>
<tr class="memdesc:a538f36e08b749716e6dd4c50679e2ee1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the allowed tokens based on the current state.  <br /></td></tr>
<tr class="separator:a538f36e08b749716e6dd4c50679e2ee1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1068b4fa2167039fe04519ec4db65278" id="r_a1068b4fa2167039fe04519ec4db65278"><td class="memItemLeft" align="right" valign="top">typing.Any&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1068b4fa2167039fe04519ec4db65278">mask_logits</a> (self, logits)</td></tr>
<tr class="memdesc:a1068b4fa2167039fe04519ec4db65278"><td class="mdescLeft">&#160;</td><td class="mdescRight">Mask the logits based on the current state.  <br /></td></tr>
<tr class="separator:a1068b4fa2167039fe04519ec4db65278"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5d565301d527fd3a56ca86a98df9afaf" id="r_a5d565301d527fd3a56ca86a98df9afaf"><td class="memItemLeft" align="right" valign="top">typing.Sequence[int]&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5d565301d527fd3a56ca86a98df9afaf">get_allowed_tokens_since_last_computation</a> (self)</td></tr>
<tr class="memdesc:a5d565301d527fd3a56ca86a98df9afaf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the allowed tokens since the last computation(in other words, the last call to <code>compute_allowed_tokens</code>).  <br /></td></tr>
<tr class="separator:a5d565301d527fd3a56ca86a98df9afaf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac15aeec180daa5c78ad3c9bd93bd2b5b" id="r_ac15aeec180daa5c78ad3c9bd93bd2b5b"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac15aeec180daa5c78ad3c9bd93bd2b5b">is_completed</a> (self)</td></tr>
<tr class="memdesc:ac15aeec180daa5c78ad3c9bd93bd2b5b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if the generation is completed.  <br /></td></tr>
<tr class="separator:ac15aeec180daa5c78ad3c9bd93bd2b5b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a10ff1aac8dcd90e1bd983d2f6580a964" id="r_a10ff1aac8dcd90e1bd983d2f6580a964"><td class="memItemLeft" align="right" valign="top">None&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a10ff1aac8dcd90e1bd983d2f6580a964">reset</a> (self)</td></tr>
<tr class="memdesc:a10ff1aac8dcd90e1bd983d2f6580a964"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reset the formatter to the initial state.  <br /></td></tr>
<tr class="separator:a10ff1aac8dcd90e1bd983d2f6580a964"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a827c993f0ac74abff6276b3af6058e3f" id="r_a827c993f0ac74abff6276b3af6058e3f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a827c993f0ac74abff6276b3af6058e3f">__str__</a> (self)</td></tr>
<tr class="separator:a827c993f0ac74abff6276b3af6058e3f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-methods" name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:ae4be840a942f608c1a0c256dbf68901b" id="r_ae4be840a942f608c1a0c256dbf68901b"><td class="memItemLeft" align="right" valign="top">str&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae4be840a942f608c1a0c256dbf68901b">_obtain_accepted_output</a> (self)</td></tr>
<tr class="separator:ae4be840a942f608c1a0c256dbf68901b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac6f7e3f96c6318689c5cd0d44a1cdde7" id="r_ac6f7e3f96c6318689c5cd0d44a1cdde7"><td class="memItemLeft" align="right" valign="top">None&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac6f7e3f96c6318689c5cd0d44a1cdde7">_on_completion</a> (self, str generated_output)</td></tr>
<tr class="memdesc:ac6f7e3f96c6318689c5cd0d44a1cdde7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform actions when the generation is completed.  <br /></td></tr>
<tr class="separator:ac6f7e3f96c6318689c5cd0d44a1cdde7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-attribs" name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:a77fc80d958ed5878393546c1a24d75e5" id="r_a77fc80d958ed5878393546c1a24d75e5"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a77fc80d958ed5878393546c1a24d75e5">_extractors</a></td></tr>
<tr class="separator:a77fc80d958ed5878393546c1a24d75e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a73ef6ac966b418215e6c216a90520860" id="r_a73ef6ac966b418215e6c216a90520860"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a73ef6ac966b418215e6c216a90520860">_engine</a></td></tr>
<tr class="separator:a73ef6ac966b418215e6c216a90520860"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adf232d46083546ae3363e4ce007a335b" id="r_adf232d46083546ae3363e4ce007a335b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#adf232d46083546ae3363e4ce007a335b">_token_id_or_bytes</a></td></tr>
<tr class="separator:adf232d46083546ae3363e4ce007a335b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9535e6eb6b8001d6f5fc90ee549ecacb" id="r_a9535e6eb6b8001d6f5fc90ee549ecacb"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9535e6eb6b8001d6f5fc90ee549ecacb">_decode_callback</a></td></tr>
<tr class="separator:a9535e6eb6b8001d6f5fc90ee549ecacb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aac1bf058d35745650f1838ea64b66ad2" id="r_aac1bf058d35745650f1838ea64b66ad2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aac1bf058d35745650f1838ea64b66ad2">_grammar_str</a></td></tr>
<tr class="separator:aac1bf058d35745650f1838ea64b66ad2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a43964a72280fd307cd74528657beeca3" id="r_a43964a72280fd307cd74528657beeca3"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a43964a72280fd307cd74528657beeca3">_captures</a></td></tr>
<tr class="separator:a43964a72280fd307cd74528657beeca3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader">Properties</h2></td></tr>
<tr class="memitem:a2519969e1338beb864169289a6f36bb9" id="r_a2519969e1338beb864169289a6f36bb9"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2519969e1338beb864169289a6f36bb9">grammar_str</a> (self)</td></tr>
<tr class="memdesc:a2519969e1338beb864169289a6f36bb9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the KBNF grammar string.  <br /></td></tr>
<tr class="separator:a2519969e1338beb864169289a6f36bb9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af69cc99bea2c85c4ca5af0ecc01c5db1" id="r_af69cc99bea2c85c4ca5af0ecc01c5db1"><td class="memItemLeft" align="right" valign="top">dict[str, typing.Any]|None&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af69cc99bea2c85c4ca5af0ecc01c5db1">captures</a> (self)</td></tr>
<tr class="memdesc:af69cc99bea2c85c4ca5af0ecc01c5db1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the captures from the generated string.  <br /></td></tr>
<tr class="separator:af69cc99bea2c85c4ca5af0ecc01c5db1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock">
<p class="definition">Definition at line <a class="el" href="formatter_8py_source.html#l00112">112</a> of file <a class="el" href="formatter_8py_source.html">formatter.py</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a369269f53f32be2f1d92663670354515" name="a369269f53f32be2f1d92663670354515"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a369269f53f32be2f1d92663670354515">&#9670;&#160;</a></span>__init__()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">formatron.formatter.Formatter.__init__ </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">list[<a class="el" href="classformatron_1_1extractor_1_1Extractor.html">Extractor</a>]</td>          <td class="paramname"><span class="paramname"><em>extractors</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">kbnf.Engine</td>          <td class="paramname"><span class="paramname"><em>engine</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">typing.Callable[[list[int]], str]</td>          <td class="paramname"><span class="paramname"><em>decode_callback</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">str</td>          <td class="paramname"><span class="paramname"><em>grammar_str</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize the formatter. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">extractors</td><td>The matchers to extract data from the generated string. </td></tr>
    <tr><td class="paramname">engine</td><td>The KBNF engine to enforce the format. </td></tr>
    <tr><td class="paramname">decode_callback</td><td>The callback to decode the token IDs to a string. </td></tr>
    <tr><td class="paramname">grammar_str</td><td>The KBNF grammar string. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="formatter_8py_source.html#l00122">122</a> of file <a class="el" href="formatter_8py_source.html">formatter.py</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a827c993f0ac74abff6276b3af6058e3f" name="a827c993f0ac74abff6276b3af6058e3f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a827c993f0ac74abff6276b3af6058e3f">&#9670;&#160;</a></span>__str__()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">formatron.formatter.Formatter.__str__ </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="formatter_8py_source.html#l00262">262</a> of file <a class="el" href="formatter_8py_source.html">formatter.py</a>.</p>

</div>
</div>
<a id="ae4be840a942f608c1a0c256dbf68901b" name="ae4be840a942f608c1a0c256dbf68901b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae4be840a942f608c1a0c256dbf68901b">&#9670;&#160;</a></span>_obtain_accepted_output()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">str formatron.formatter.Formatter._obtain_accepted_output </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="formatter_8py_source.html#l00155">155</a> of file <a class="el" href="formatter_8py_source.html">formatter.py</a>.</p>

</div>
</div>
<a id="ac6f7e3f96c6318689c5cd0d44a1cdde7" name="ac6f7e3f96c6318689c5cd0d44a1cdde7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac6f7e3f96c6318689c5cd0d44a1cdde7">&#9670;&#160;</a></span>_on_completion()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"> None formatron.formatter.Formatter._on_completion </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">str</td>          <td class="paramname"><span class="paramname"><em>generated_output</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Perform actions when the generation is completed. </p>

<p>Reimplemented from <a class="el" href="classformatron_1_1formatter_1_1FormatterBase.html#a469880a21192928e82823cc340a22ce2">formatron.formatter.FormatterBase</a>.</p>

<p class="definition">Definition at line <a class="el" href="formatter_8py_source.html#l00209">209</a> of file <a class="el" href="formatter_8py_source.html">formatter.py</a>.</p>

</div>
</div>
<a id="a178a37715ce463e6e57c530166c7ec6d" name="a178a37715ce463e6e57c530166c7ec6d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a178a37715ce463e6e57c530166c7ec6d">&#9670;&#160;</a></span>accept_bytes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">kbnf.AcceptTokenResult formatron.formatter.Formatter.accept_bytes </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bytes</td>          <td class="paramname"><span class="paramname"><em>_bytes</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Accept a bytes object from the language model. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">_bytes</td><td>The bytes object. </td></tr>
  </table>
  </dd>
</dl>

<p>Reimplemented from <a class="el" href="classformatron_1_1formatter_1_1FormatterBase.html#ac0f91549079380a53228322dd4473cf1">formatron.formatter.FormatterBase</a>.</p>

<p class="definition">Definition at line <a class="el" href="formatter_8py_source.html#l00184">184</a> of file <a class="el" href="formatter_8py_source.html">formatter.py</a>.</p>

</div>
</div>
<a id="a839eb7550ee4afbd305b25ddcca5c4dc" name="a839eb7550ee4afbd305b25ddcca5c4dc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a839eb7550ee4afbd305b25ddcca5c4dc">&#9670;&#160;</a></span>accept_token()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">kbnf.AcceptTokenResult formatron.formatter.Formatter.accept_token </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>token_id</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Accept a token from the language model. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">token_id</td><td>The token ID. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The result of accepting the token. </dd></dl>

<p>Reimplemented from <a class="el" href="classformatron_1_1formatter_1_1FormatterBase.html#a87d1513c3f70fdee18d65fae4f71101d">formatron.formatter.FormatterBase</a>.</p>

<p class="definition">Definition at line <a class="el" href="formatter_8py_source.html#l00147">147</a> of file <a class="el" href="formatter_8py_source.html">formatter.py</a>.</p>

</div>
</div>
<a id="af69cc99bea2c85c4ca5af0ecc01c5db1" name="af69cc99bea2c85c4ca5af0ecc01c5db1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af69cc99bea2c85c4ca5af0ecc01c5db1">&#9670;&#160;</a></span>captures()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> dict[str, typing.Any] | None formatron.formatter.Formatter.captures </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the captures from the generated string. </p>
<p>Note that the captures are only available for one extractor if:</p><ul>
<li>The extractor has a capture name.</li>
<li><a class="el" href="#ac15aeec180daa5c78ad3c9bd93bd2b5b" title="Check if the generation is completed.">Formatter.is_completed()</a> returns True.</li>
<li>The extractor successfully extracts the data.<ul>
<li>This means the extractor identifies the correct string span to extract and whatever post-processing the extractor does on the extracted string is successful.</li>
</ul>
</li>
</ul>
<p>Captures are obtained by calling <code><a class="el" href="classformatron_1_1extractor_1_1Extractor.html#a9efb2a75cf5fc5e0919c235aa1435469" title="Extract data from the input string, or None if the extraction failed.">Extractor.extract</a></code> method on the generated string in the sequence of extractors appended to the formatter. Note that the previous extractors does not 'see' the semantics of the later extractors. For example, consider the following formatter: <code>python @code f = FormatterBuilder() f.append_line(f"{f.regex('.*?', capture_name='a')}{f.regex('.*', capture_name='b')}") f = f.build() @endcode </code> The <code>b</code> extractor will always corresponding to <code>None</code> because the <code>a</code> extractor will always extract the whole string. This behavior is different from what a typical regular expression engine would do! </p>

<p>Reimplemented from <a class="el" href="classformatron_1_1formatter_1_1FormatterBase.html#ab6682619840e83727264a945953fe964">formatron.formatter.FormatterBase</a>.</p>

<p class="definition">Definition at line <a class="el" href="formatter_8py_source.html#l00252">252</a> of file <a class="el" href="formatter_8py_source.html">formatter.py</a>.</p>

</div>
</div>
<a id="a538f36e08b749716e6dd4c50679e2ee1" name="a538f36e08b749716e6dd4c50679e2ee1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a538f36e08b749716e6dd4c50679e2ee1">&#9670;&#160;</a></span>compute_allowed_tokens()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> None formatron.formatter.Formatter.compute_allowed_tokens </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute the allowed tokens based on the current state. </p>

<p>Reimplemented from <a class="el" href="classformatron_1_1formatter_1_1FormatterBase.html#a927b160d994d43c4e38807f94ea69069">formatron.formatter.FormatterBase</a>.</p>

<p class="definition">Definition at line <a class="el" href="formatter_8py_source.html#l00192">192</a> of file <a class="el" href="formatter_8py_source.html">formatter.py</a>.</p>

</div>
</div>
<a id="a5d565301d527fd3a56ca86a98df9afaf" name="a5d565301d527fd3a56ca86a98df9afaf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5d565301d527fd3a56ca86a98df9afaf">&#9670;&#160;</a></span>get_allowed_tokens_since_last_computation()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> typing.Sequence[int] formatron.formatter.Formatter.get_allowed_tokens_since_last_computation </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the allowed tokens since the last computation(in other words, the last call to <code>compute_allowed_tokens</code>). </p>
<dl class="section return"><dt>Returns</dt><dd>The allowed tokens. </dd></dl>

<p>Reimplemented from <a class="el" href="classformatron_1_1formatter_1_1FormatterBase.html#ab77855193118e33bf8247c5709a0f485">formatron.formatter.FormatterBase</a>.</p>

<p class="definition">Definition at line <a class="el" href="formatter_8py_source.html#l00198">198</a> of file <a class="el" href="formatter_8py_source.html">formatter.py</a>.</p>

</div>
</div>
<a id="a2519969e1338beb864169289a6f36bb9" name="a2519969e1338beb864169289a6f36bb9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2519969e1338beb864169289a6f36bb9">&#9670;&#160;</a></span>grammar_str()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">formatron.formatter.Formatter.grammar_str </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the KBNF grammar string. </p>

<p class="definition">Definition at line <a class="el" href="formatter_8py_source.html#l00142">142</a> of file <a class="el" href="formatter_8py_source.html">formatter.py</a>.</p>

</div>
</div>
<a id="ac15aeec180daa5c78ad3c9bd93bd2b5b" name="ac15aeec180daa5c78ad3c9bd93bd2b5b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac15aeec180daa5c78ad3c9bd93bd2b5b">&#9670;&#160;</a></span>is_completed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> bool formatron.formatter.Formatter.is_completed </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check if the generation is completed. </p>
<p>This means the generation is ended by the engine. If the generation is ended by integration-specific stop conditions like <code>max_new_tokens</code>, the generation is not considered completed by this method. </p>

<p>Reimplemented from <a class="el" href="classformatron_1_1formatter_1_1FormatterBase.html#ac9af60077533ed0f3c9f42ee3a132899">formatron.formatter.FormatterBase</a>.</p>

<p class="definition">Definition at line <a class="el" href="formatter_8py_source.html#l00206">206</a> of file <a class="el" href="formatter_8py_source.html">formatter.py</a>.</p>

</div>
</div>
<a id="a1068b4fa2167039fe04519ec4db65278" name="a1068b4fa2167039fe04519ec4db65278"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1068b4fa2167039fe04519ec4db65278">&#9670;&#160;</a></span>mask_logits()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> typing.Any formatron.formatter.Formatter.mask_logits </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>logits</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Mask the logits based on the current state. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">logits</td><td>The logits to mask. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The masked logits. </dd></dl>

<p>Reimplemented from <a class="el" href="classformatron_1_1formatter_1_1FormatterBase.html#ae8db7e92a900322ae5aa603b5c8f386f">formatron.formatter.FormatterBase</a>.</p>

<p class="definition">Definition at line <a class="el" href="formatter_8py_source.html#l00195">195</a> of file <a class="el" href="formatter_8py_source.html">formatter.py</a>.</p>

</div>
</div>
<a id="a10ff1aac8dcd90e1bd983d2f6580a964" name="a10ff1aac8dcd90e1bd983d2f6580a964"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a10ff1aac8dcd90e1bd983d2f6580a964">&#9670;&#160;</a></span>reset()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> None formatron.formatter.Formatter.reset </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reset the formatter to the initial state. </p>

<p>Reimplemented from <a class="el" href="classformatron_1_1formatter_1_1FormatterBase.html#a522c78b1404697a99313f9edffa7a2a4">formatron.formatter.FormatterBase</a>.</p>

<p class="definition">Definition at line <a class="el" href="formatter_8py_source.html#l00257">257</a> of file <a class="el" href="formatter_8py_source.html">formatter.py</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a43964a72280fd307cd74528657beeca3" name="a43964a72280fd307cd74528657beeca3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a43964a72280fd307cd74528657beeca3">&#9670;&#160;</a></span>_captures</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">formatron.formatter.Formatter._captures</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="formatter_8py_source.html#l00129">129</a> of file <a class="el" href="formatter_8py_source.html">formatter.py</a>.</p>

</div>
</div>
<a id="a9535e6eb6b8001d6f5fc90ee549ecacb" name="a9535e6eb6b8001d6f5fc90ee549ecacb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9535e6eb6b8001d6f5fc90ee549ecacb">&#9670;&#160;</a></span>_decode_callback</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">formatron.formatter.Formatter._decode_callback</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="formatter_8py_source.html#l00127">127</a> of file <a class="el" href="formatter_8py_source.html">formatter.py</a>.</p>

</div>
</div>
<a id="a73ef6ac966b418215e6c216a90520860" name="a73ef6ac966b418215e6c216a90520860"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a73ef6ac966b418215e6c216a90520860">&#9670;&#160;</a></span>_engine</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">formatron.formatter.Formatter._engine</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="formatter_8py_source.html#l00125">125</a> of file <a class="el" href="formatter_8py_source.html">formatter.py</a>.</p>

</div>
</div>
<a id="a77fc80d958ed5878393546c1a24d75e5" name="a77fc80d958ed5878393546c1a24d75e5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a77fc80d958ed5878393546c1a24d75e5">&#9670;&#160;</a></span>_extractors</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">formatron.formatter.Formatter._extractors</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="formatter_8py_source.html#l00124">124</a> of file <a class="el" href="formatter_8py_source.html">formatter.py</a>.</p>

</div>
</div>
<a id="aac1bf058d35745650f1838ea64b66ad2" name="aac1bf058d35745650f1838ea64b66ad2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aac1bf058d35745650f1838ea64b66ad2">&#9670;&#160;</a></span>_grammar_str</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">formatron.formatter.Formatter._grammar_str</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="formatter_8py_source.html#l00128">128</a> of file <a class="el" href="formatter_8py_source.html">formatter.py</a>.</p>

</div>
</div>
<a id="adf232d46083546ae3363e4ce007a335b" name="adf232d46083546ae3363e4ce007a335b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adf232d46083546ae3363e4ce007a335b">&#9670;&#160;</a></span>_token_id_or_bytes</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">formatron.formatter.Formatter._token_id_or_bytes</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="formatter_8py_source.html#l00126">126</a> of file <a class="el" href="formatter_8py_source.html">formatter.py</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>src/formatron/<a class="el" href="formatter_8py_source.html">formatter.py</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespaceformatron.html">formatron</a></li><li class="navelem"><a class="el" href="namespaceformatron_1_1formatter.html">formatter</a></li><li class="navelem"><a class="el" href="classformatron_1_1formatter_1_1Formatter.html">Formatter</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.11.0 </li>
  </ul>
</div>
</body>
</html>
